---
title: Next.js with Xata starter guide
navTitle: Next.js
keywords: ['nextjs']
description: Get started with Next.js and Xata
slug: getting-started/nextjs
published: true
---

In this guide, we'll create a new [Next.js][2] application and walk through adding Xata database and search functionality to it. We'll build a basic blog application to demonstrate the funcationality, however you can apply these basics to other types of app.

The completed [Next.js and Xata code](https://github.com/xataio/examples/tree/main/apps/nextjs-getting-started) for this guide is available via the [Xata `examples` repo](https://github.com/xataio/examples) on GitHub.

## Before you begin

Install the Xata CLI:

```sh
npm install -g @xata.io/cli
```

And login to your Xata account with the Xata CLI. Running the following command will open a new browser window. If you're not already logged into Xata you can go through the login or signup process. Run the following command to begin the authentication workflow:

```sh
xata auth login
```

On completion the command will create a new API key for your user account which you should [see in account settings page within the Xata UI][1]. That key will also be stored locally on your computer (the location might vary for each OS). It looks like this:

```toml
# .config/xata/credentials
[default]
apiKey=YOUR_API_KEY_HERE
```

## Create a new Next.js app

Let's begin by creating a new Next.js application:

```sh
npx create-next-app@latest --typescript xata-nextjs
```

<details>
  <summary><code>npx create-next-app</code> output</summary>
  $ npx create-next-app@latest --typescript xata-nextjs
  Need to install the following packages:
  create-next-app@13.4.13
  Ok to proceed? (y)
  âœ” Would you like to use ESLint? â€¦ No / Yes
  âœ” Would you like to use Tailwind CSS? â€¦ No / Yes
  âœ” Would you like to use `src/` directory? â€¦ No / Yes
  âœ” Would you like to use App Router? (recommended) â€¦ No / Yes
  âœ” Would you like to customize the default import alias? â€¦ No / Yes
  Creating a new Next.js app in ./xata-nextjs.

Using npm.

Initializing project with template: app-tw

Installing dependencies:

- react
- react-dom
- next
- typescript
- @types/react
- @types/node
- @types/react-dom
- tailwindcss
- postcss
- autoprefixer
- eslint
- eslint-config-next

added 314 packages, and audited 315 packages in 22s

107 packages are looking for funding
run `npm fund` for details

found 0 vulnerabilities
Initialized a git repository.

Success! Created xata-nextjs at ./xata-nextjs

</details>

Once the command has completed, move to the `xata-nextjs` directory and run the application:

```sh
cd xata-nextjs
npm run dev
```

By default the application will run on `http://localhost:3000`.

## Create a new database

With the Xata CLI installed and logged in, and a new Next.js application in place, use the Xata CLI to create a new database. Accept all the prompt defaults for the following command:

```sh
xata init
```

<details>
  <summary><code>xata init</code> output</summary>

  <pre>
    $ xata init\
    ðŸ¦‹ Initializing project... We will ask you some questions.

    You have a single workspace, using it by default: Phil-Leggetter-s-workspace-hc84d7
    âœ” Select a database or create a new one â€º \<Create a new database>
    âœ” New database name â€¦ xata-nextjs-run-through-1
    âœ” Select a region â€º eu-west-1
    âœ” Add .env to .gitignore? â€¦ yes
    âœ” Generate code and types from your Xata database â€º TypeScript
    âœ” Choose the output path for the generated code â€¦ src/xata.ts

    Setting up Xata...

    Created Xata config: .xatarc

    Creating .env file
    set XATA\*API\_KEY=xau\*\*\*\*\*\***\***\*\*\*\***\***\*\***\*\*\*\***\*\*\*\*
    set XATA\_BRANCH=main

    Added .env file to .gitignore

    i Running npm install --save @xata.io/client

    added 1 package, and audited 316 packages in 992ms

    107 packages are looking for funding
    run `npm fund` for details

    found 0 vulnerabilities

    No new migrations to pull from main branch
    Generated Xata code to ./src/xata.ts

    âœ” Project setup with Xata ðŸ¦‹

    i Setup tables and columns at https://app.xata.io/workspaces/xata-workspace-hc84d7/dbs/xata-nextjs:eu-west-1

    i Use xata pull main to regenerate code and types from your Xata database
  </pre>

</details>

On completion the CLI will create `.env`, `.xatarc`, and `src/xata.ts` files within your project folder with the correct credentials to access your database.

Your `.env` file should look something like this:

```bash title=".env"
XATA_API_KEY=YOUR_API_KEY_HERE
XATA_BRANCH=main
```

Since we selected TypeScript support it also created files that provide typings and functions to call using Xata's TypeScript SDK. This will additionally be referenced in the `.xatarc` file as follows:

```json
{
  "databaseUrl": "https://xata-nextjs-database-url"
  "codegen": {
    "output": "src/xata.ts"
  }
}
```

The `src/xata.ts` includes generated code that typically you should never touch manually.

## Define the datbase schema and seed via CSV import

You can use the [Xata UI][0] to manually define your schema and add data. However, for this guide we'll walk through using the Xata CLI and a CSV file to:

1.  Auto generate a schema based on column headings for names and data types inferred from the column values
2.  Seed the database with data

**TODO: Update URL to CSV file**

First, download the [example posts CSV file](https://raw.githubusercontent.com/leggetter/xata-examples/nextjs-getting-started/apps/getting-started-nextjs/seed/blog-posts.csv). You can either do this manually or by running the follow command:

```sh
curl https://raw.githubusercontent.com/leggetter/xata-examples/nextjs-getting-started/apps/getting-started-nextjs/seed/blog-posts.csv --create-dirs -o seed/blog-posts.csv
```

Next, import the CSV:

```sh
xata import csv seed/blog-posts.csv --table Posts --create
```

Now, if you open up the Xata UI and navigate to your database (you can also run `xata browse` to open up a browser window), you will see the **Posts** table:

![Posts table](images/xata-table-posts.png)

Click on the **Schema** link to see the schema definition with the interred data types:

![Posts schema](images/xata-schema-posts.png)

## Query and list the posts

## Query and show a single posts

## Search posts

## What you've learned

## Where next

---

## Create a new Next.js app

To start lets create a Next.js application. Set it up with typescript support so that we can utilize the SDK later in this tutorial.

```bash
npx create-next-app@latest --typescript my-xata-app
```

For the purpose of this tutorial, we're going to assume you named this project `my-xata-app`. Move to that directory, and run `npm run dev` to see your website at http://localhost:3000

### Initialize Xata in your my-xata-app directory

Xata needs a few things to communicate with the databases we set up. It needs to know the location of the database, along with the API key it can use to request data from that location. These are stored in the project root directory within `.env` and `.xatarc` respectively. We can use the newly installed CLI to initialize any project with these details.

```bash
# cd into /path-to/my-xata-app
xata init
```

This will prompt you to answer some questions about whether you are creating a new database or utilizing an existing one. If you followed the instructions above you should choose to use the existing `my-xata-app` database. Also choose to use `TypeScript codegen` to follow along with this tutorial. On completion the CLI will create `.env`, `.xatarc`, and `src/xata.ts` files within your project folder with the correct credentials to access your database.

Your `.env` file should look something like this.

```bash
# You should now have a ~/my-xata-project/.env file
XATA_API_KEY=YOUR_API_KEY_HERE
XATA_BRANCH=main
```

Since we asked for TypeScript support it also created files that provide typings and functions to call using Xata's TypeScript SDK. This will additionally be referenced in the `.xatarc` file as follows.

```json
{
  "databaseUrl": "https://my-xata-app-database-url"
  "codegen": {
    "output": "src/xata.ts"
  }
}
```

The `src/xata.ts` includes generated code that typically you should never touch manually. If you change the schema of your `my-xata-app` database, like adding a column to `Posts`, you'll want to run `xata pull` to update the typings within that file.

```bash
# To update the contents of ~/project/src/.xatarc
xata pull main
```

## Create a new page to output our posts

Create a new file at `src/pages/posts.tsx` and start with a typical Hello World output. Next JS will render and pages added to the `pages` directory as distinct URL. This means we can find our new page at https://localhost:3000/posts

```tsx
export default function PostsListsPage() {
  return (
    <>
      <h1>My xata posts</h1>
    </>
  );
}
```

Next let's import the `getXataClient` function which was provided to us by the `xata init` command that was run earlier. It should have placed the file in `src/xata.ts`. You'll notice that if we save this file, Next.js will error out with the following message.

<Alert status="warning">
  Error: You are trying to use Xata from the browser, which is potentially a non-secure environment. If you understand
  the security concerns, such as leaking your credentials, pass `enableBrowser: true` to the client options to remove
  this error.
</Alert>

```tsx {1-3}
import { getXataClient } from '../xata';
// We'll assign the client to xata to make it easier to call
const xata = getXataClient();

export default function PostsListPage() {
  return (
    <>
      <h1>My xata posts</h1>
    </>
  );
}
```

To fix the error we'll need to utilize the Xata client in Next.js's server-side mode. This can be done with the `getServerSideProps` function that Next.js provides.

```tsx {4-13}
import { getXataClient } from '../xata';
const xata = getXataClient();

// We will make the query to Xata on the server.
// This will allow the query to read the API_KEY from the .env file
export const getServerSideProps = async () => {
  const records = await xata.db.Posts.getMany();
  return {
    props: {
      records
    }
  };
};

export default function PostsListPage() {
  return (
    <>
      <h1>My xata posts</h1>
    </>
  );
}
```

On save, you'll notice the page still errors:

<Alert status="warning">
  Error: Error serializing `.records[0].xata.createdAt` returned from `getServerSideProps` in "/posts". `object`
  ("\[object Date]") cannot be serialized as JSON. Only return JSON serializable data types.
</Alert>

This error occurs because Xata stores date fields as an object. To resolve this issue, use the `toSerializable` function that is provided by the SDK. Note that the type returned by `toSerializable()` is `JSONData<PostsRecord>`. This helper type converts all properties to JSON serializable. This means they can be passed client-side while still keeping the end-to-end type safety of TypeScript.

```tsx {10}
import { getXataClient } from '../xata';
const xata = getXataClient();

// We will make the query to Xata on the server.
// This will allow the query to read the API_KEY from the .env file
export const getServerSideProps = async () => {
  const records = await xata.db.Posts.getMany();
  return {
    props: {
      records: records.map((record) => record.toSerializable())
    }
  };
};

export default function PostsListPage() {
  return (
    <>
      <h1>My xata posts</h1>
    </>
  );
}
```

On save our page should contain no errors. The last thing to do is pass our newly created server-side props to the render so we can see the results on the page.

```tsx {17-36}
import { getXataClient, PostsRecord } from '../xata';
// We'll assign the client to xata to make it easier to call
const xata = getXataClient();

// We will make the query to Xata on the server.
// This will allow the query to read the API_KEY from the .env file
export const getServerSideProps = async () => {
  const records = await xata.db.Posts.getMany();
  return {
    props: {
      records: records.map((record) => record.toSerializable())
    }
  };
};

// Pass the props defined above to the page and map against it
export default function PostsListPage({ records }: InferGetServerSidePropsType<typeof getServerSideProps>) {
  return (
    <>
      <h1>My xata posts</h1>
      {records.map((record) => (
        <div key={record.id}>
          <h2>{record.title}</h2>
          <p>{record.id}</p>
          <p>{record.body}</p>
          <p>{record.pubDate}</p>
        </div>
      ))}
    </>
  );
}
```

In Next.js, it is recommended to use the `InferGetServerSidePropsType` helper to infer the type of the props returned by `getServerSideProps`, so that types match the query results.

At this point you should have a basic understanding of how to query Xata records from the Database with Next.js.

[0]: https://app.xata.io
[1]: https://app.xata.io/settings
[2]: https://nextjs.org/
